<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Functional Neural Networks with Cross-validation — fnn.cv • FNN</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Functional Neural Networks with Cross-validation — fnn.cv" />

<meta property="og:description" content="This is a convenience function for the user. The inputs are largely the same as the fnn.fit() function with the
additional parameter of fold choice. This function only works for scalar responses." />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FNN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FNN.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Main</li>
    <li>
      <a href="../articles/FNN_vignette_temp.html">Vignette #1</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/b-thi/FNN/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functional Neural Networks with Cross-validation</h1>
    <small class="dont-index">Source: <a href='https://github.com/b-thi/FNN/blob/master/R/fnn.cv.R'><code>R/fnn.cv.R</code></a></small>
    <div class="hidden name"><code>fnn.cv.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is a convenience function for the user. The inputs are largely the same as the <code><a href='fnn.fit.html'>fnn.fit()</a></code> function with the
additional parameter of fold choice. This function only works for scalar responses.</p>
    
    </div>

    <pre class="usage"><span class='fu'>fnn.cv</span>(
  <span class='no'>nfolds</span>,
  <span class='no'>resp</span>,
  <span class='no'>func_cov</span>,
  <span class='kw'>scalar_cov</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>basis_choice</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"fourier"</span>),
  <span class='kw'>num_basis</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>7</span>),
  <span class='kw'>hidden_layers</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>neurons_per_layer</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>64</span>, <span class='fl'>64</span>),
  <span class='kw'>activations_in_layers</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sigmoid"</span>, <span class='st'>"linear"</span>),
  <span class='kw'>domain_range</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>)),
  <span class='kw'>epochs</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>loss_choice</span> <span class='kw'>=</span> <span class='st'>"mse"</span>,
  <span class='kw'>metric_choice</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"mean_squared_error"</span>),
  <span class='kw'>val_split</span> <span class='kw'>=</span> <span class='fl'>0.2</span>,
  <span class='kw'>learn_rate</span> <span class='kw'>=</span> <span class='fl'>0.001</span>,
  <span class='kw'>patience_param</span> <span class='kw'>=</span> <span class='fl'>15</span>,
  <span class='kw'>early_stopping</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='kw'>print_info</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>32</span>,
  <span class='kw'>decay_rate</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>func_resp_method</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>covariate_scaling</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='kw'>raw_data</span> <span class='kw'>=</span> <span class='no'>F</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nfolds</th>
      <td><p>The number of folds to be used in the cross-validation process.</p></td>
    </tr>
    <tr>
      <th>resp</th>
      <td><p>For scalar responses, this is a vector of the observed dependent variable. For functional responses,
this is a matrix where each row contains the basis coefficients defining the functional response (for each observation).</p></td>
    </tr>
    <tr>
      <th>func_cov</th>
      <td><p>The form of this depends on whether the <code>raw_data</code> argument is true or not. If true, then this is
a list of k matrices. The dimensionality of the matrices should be the same (n x p) where n is the number of
observations and p is the number of longitudinal observations. If <code>raw_data</code> is false, then the input should be a tensor
with dimensionality b x n x k where b is the number of basis functions used to define the functional covariates, n is
the number of observations, and k is the number of functional covariates.</p></td>
    </tr>
    <tr>
      <th>scalar_cov</th>
      <td><p>A matrix contained the multivariate information associated with the data set. This is all of your
non-longitudinal data.</p></td>
    </tr>
    <tr>
      <th>basis_choice</th>
      <td><p>A vector of size k (the number of functional covariates) with either "fourier" or "bspline" as the inputs.
This is the choice for the basis functions used for the functional weight expansion. If you only specify one, with k &gt; 1,
then the argument will repeat that choice for all k functional covariates.</p></td>
    </tr>
    <tr>
      <th>num_basis</th>
      <td><p>A vector of size k defining the number of basis functions to be used in the basis expansion. Must be odd
for <code>fourier</code> basis choices. If you only specify one, with k &gt; 1, then the argument will repeat that choice for all
k functional covariates.</p></td>
    </tr>
    <tr>
      <th>hidden_layers</th>
      <td><p>The number of hidden layers to be used in the neural network.</p></td>
    </tr>
    <tr>
      <th>neurons_per_layer</th>
      <td><p>Vector of size = <code>hidden_layers</code>. The u-th element of the vector corresponds to the number of neurons
in the u-th hidden layer.</p></td>
    </tr>
    <tr>
      <th>activations_in_layers</th>
      <td><p>Vector of size = <code>hidden_layers</code>. The u-th element of the vector corresponds to the
activation choice in the u-th hidden layer.</p></td>
    </tr>
    <tr>
      <th>domain_range</th>
      <td><p>List of size k. Each element of the list is a 2-dimensional vector containing the upper and lower
bounds of the k-th functional weight.</p></td>
    </tr>
    <tr>
      <th>epochs</th>
      <td><p>The number of training iterations.</p></td>
    </tr>
    <tr>
      <th>loss_choice</th>
      <td><p>This parameter defines the loss function used in the learning process.</p></td>
    </tr>
    <tr>
      <th>metric_choice</th>
      <td><p>This parameter defines the printed out error metric.</p></td>
    </tr>
    <tr>
      <th>val_split</th>
      <td><p>A parameter that decides the percentage split of the inputted data set.</p></td>
    </tr>
    <tr>
      <th>learn_rate</th>
      <td><p>Hyperparameter that defines how quickly you move in the direction of the gradient.</p></td>
    </tr>
    <tr>
      <th>patience_param</th>
      <td><p>A keras parameter that decides how many additional <code>epochs</code> are eclipsed with minimal change in
error before the learning process is stopped. This is only active if <code>early_stopping = T</code></p></td>
    </tr>
    <tr>
      <th>early_stopping</th>
      <td><p>If True, then learning process will be halted early if error improvement isn't seen.</p></td>
    </tr>
    <tr>
      <th>print_info</th>
      <td><p>If True, function will output information about the model as it is trained.</p></td>
    </tr>
    <tr>
      <th>batch_size</th>
      <td><p>Size of the batch for stochastic gradient descent.</p></td>
    </tr>
    <tr>
      <th>decay_rate</th>
      <td><p>A modification to the learning rate that decreases the learning rate as more and more learning
iterations are completed.</p></td>
    </tr>
    <tr>
      <th>func_resp_method</th>
      <td><p>Set to 1 by default. In the future, this will be set to 2 for an alternative functional response
approach.</p></td>
    </tr>
    <tr>
      <th>covariate_scaling</th>
      <td><p>If True, then data will be internally scaled before model development.</p></td>
    </tr>
    <tr>
      <th>raw_data</th>
      <td><p>If True, then user does not need to create functional observations beforehand. The function will
internally take care of that pre-processing.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The following are returned.</p>
<p><code>predicted_folds</code> -- The predicted scalar values in each fold.</p>
<p><code>true_folds</code> -- The true values of the response in each fold.</p>
<p><code>MSPE</code> -- A list object containing the MSPE in each fold and the overall cross-validated MSPE.</p>
<p><code>fold_indices</code> -- The generated indices for each fold; for replication purposes.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>No additional details for now.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Libraries</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>fda</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: splines</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'fda'</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:graphics':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    matplot</span></div><div class='input'>
<span class='co'># Loading data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"daily"</span>)

<span class='co'># Creating functional data</span>
<span class='no'>nbasis</span> <span class='kw'>=</span> <span class='fl'>65</span>
<span class='no'>temp_data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='kw'>dim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>nbasis</span>, <span class='fl'>35</span>, <span class='fl'>1</span>))
<span class='no'>tempbasis65</span>  <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/fda/man/create.fourier.basis.html'>create.fourier.basis</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>365</span>), <span class='no'>nbasis</span>)
<span class='no'>tempbasis7</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/fda/man/create.bspline.basis.html'>create.bspline.basis</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>365</span>), <span class='fl'>7</span>, <span class='kw'>norder</span> <span class='kw'>=</span> <span class='fl'>4</span>)
<span class='no'>timepts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>, <span class='fl'>365</span>, <span class='fl'>1</span>)
<span class='no'>temp_fd</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/fda/man/Data2fd.html'>Data2fd</a></span>(<span class='no'>timepts</span>, <span class='no'>daily</span>$<span class='no'>tempav</span>, <span class='no'>tempbasis65</span>)
<span class='no'>prec_fd</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/fda/man/Data2fd.html'>Data2fd</a></span>(<span class='no'>timepts</span>, <span class='no'>daily</span>$<span class='no'>precav</span>, <span class='no'>tempbasis7</span>)
<span class='no'>prec_fd</span>$<span class='no'>coefs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span>(<span class='no'>prec_fd</span>$<span class='no'>coefs</span>)

<span class='co'># Data set up</span>
<span class='no'>temp_data</span>[,,<span class='fl'>1</span>] <span class='kw'>=</span> <span class='no'>temp_fd</span>$<span class='no'>coefs</span>
<span class='no'>resp_mat</span> <span class='kw'>=</span> <span class='no'>prec_fd</span>$<span class='no'>coefs</span>

<span class='co'># Non functional covariate</span>
<span class='no'>weather_scalar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>total_prec</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>daily</span>$<span class='no'>precav</span>, <span class='fl'>2</span>, <span class='no'>sum</span>))

<span class='co'># Setting up data to pass in to function</span>
<span class='no'>weather_data_full</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='kw'>dim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>nbasis</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>temp_data</span>), <span class='fl'>1</span>))
<span class='no'>weather_data_full</span>[,,<span class='fl'>1</span>] <span class='kw'>=</span> <span class='no'>temp_data</span>
<span class='no'>scalar_full</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>weather_scalar</span>[,<span class='fl'>1</span>])
<span class='no'>total_prec</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>daily</span>$<span class='no'>precav</span>, <span class='fl'>2</span>, <span class='no'>mean</span>)

<span class='co'># cross-validating</span>
<span class='no'>cv_example</span> <span class='kw'>&lt;-</span> <span class='fu'>fnn.cv</span>(<span class='kw'>nfolds</span> <span class='kw'>=</span> <span class='fl'>5</span>,
                     <span class='kw'>resp</span> <span class='kw'>=</span> <span class='no'>total_prec</span>,
                     <span class='kw'>func_cov</span> <span class='kw'>=</span> <span class='no'>weather_data_full</span>,
                     <span class='kw'>scalar_cov</span> <span class='kw'>=</span> <span class='no'>scalar_full</span>,
                     <span class='kw'>domain_range</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>365</span>)),
                     <span class='kw'>learn_rate</span> <span class='kw'>=</span> <span class='fl'>0.001</span>)</div><div class='output co'>#&gt; <span class='error'>Error: Installation of TensorFlow not found.</span>
#&gt; <span class='error'></span>
#&gt; <span class='error'>Python environments searched for 'tensorflow' package:</span>
#&gt; <span class='error'> C:\Program Files (x86)\Python27\python.exe</span>
#&gt; <span class='error'> C:\Users\Sidi\Anaconda2\python.exe</span>
#&gt; <span class='error'> C:\Users\Sidi\AppData\Local\Programs\Python\Python38\python.exe</span>
#&gt; <span class='error'></span>
#&gt; <span class='error'>You can install TensorFlow using the install_tensorflow() function.</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Barinder Thind, <a href='http://people.stat.sfu.ca/~cao/'>Jiguo Cao</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


