<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tuning Functional Neural Networks — fnn.tune • FNN</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Tuning Functional Neural Networks — fnn.tune" />

<meta property="og:description" content="A convenience function for the user that implements a simple grid search for the purpose of tuning. For each combination
in the grid, a cross-validated error is calculated. The best combination is returned along with additional information.
This function only works for scalar responses." />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
       </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FNN </a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version"> 1.0 </span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<!-- <li>
  <a href="../index.html">Main</a>
</li> -->
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Demos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Examples</li>
    <li>
      <a href="../articles/reg_demo.html">Regression Demo</a>
    </li>
        <li>
      <a href="../articles/class_demo.html">Classification Demo</a>
    </li>
        <li>
      <a href="../articles/cv_demo.html">Cross-validation Demo</a>
    </li>
        <li>
      <a href="../articles/tune_demo.html">Tuning Demo</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">Upcoming</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/b-thi/FNN/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tuning Functional Neural Networks</h1>
    <small class="dont-index">Source: <a href='https://github.com/b-thi/FNN/blob/master/R/fnn.tune.R'><code>R/fnn.tune.R</code></a></small>
    <div class="hidden name"><code>fnn.tune.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>A convenience function for the user that implements a simple grid search for the purpose of tuning. For each combination
in the grid, a cross-validated error is calculated. The best combination is returned along with additional information.
This function only works for scalar responses.</p>
    
    </div>

    <pre class="usage"><span class='fu'>fnn.tune</span>(
  <span class='no'>tune_list</span>,
  <span class='no'>resp</span>,
  <span class='no'>func_cov</span>,
  <span class='kw'>scalar_cov</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>basis_choice</span>,
  <span class='no'>domain_range</span>,
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>32</span>,
  <span class='kw'>decay_rate</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>nfolds</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>4</span>,
  <span class='kw'>raw_data</span> <span class='kw'>=</span> <span class='no'>F</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tune_list</th>
      <td><p>This is a list object containing the values from which to develop the grid. For each of the hyperparameters
that can be tuned for (<code>num_hidden_layers</code>, <code>neurons</code>, <code>epochs</code>, <code>val_split</code>, <code>patience</code>, <code>learn_rate</code>, <code>num_basis</code>,
<code>activation_choice</code>), the user inputs a set of values to try. Note that the combinations are found based on the number of
hidden layers. For example, if <code>num_hidden_layers</code> = 3 and <code>neurons</code> = c(8, 16), then the combinations will begin as
c(8, 8, 8), c(8, 8, 16), ..., c(16, 16, 16). Example provided below.</p></td>
    </tr>
    <tr>
      <th>resp</th>
      <td><p>For scalar responses, this is a vector of the observed dependent variable. For functional responses,
this is a matrix where each row contains the basis coefficients defining the functional response (for each observation).</p></td>
    </tr>
    <tr>
      <th>func_cov</th>
      <td><p>The form of this depends on whether the <code>raw_data</code> argument is true or not. If true, then this is
a list of k matrices. The dimensionality of the matrices should be the same (n x p) where n is the number of
observations and p is the number of longitudinal observations. If <code>raw_data</code> is false, then the input should be a tensor
with dimensionality b x n x k where b is the number of basis functions used to define the functional covariates, n is
the number of observations, and k is the number of functional covariates.</p></td>
    </tr>
    <tr>
      <th>scalar_cov</th>
      <td><p>A matrix contained the multivariate information associated with the data set. This is all of your
non-longitudinal data.</p></td>
    </tr>
    <tr>
      <th>basis_choice</th>
      <td><p>A vector of size k (the number of functional covariates) with either "fourier" or "bspline" as the inputs.
This is the choice for the basis functions used for the functional weight expansion. If you only specify one, with k &gt; 1,
then the argument will repeat that choice for all k functional covariates.</p></td>
    </tr>
    <tr>
      <th>domain_range</th>
      <td><p>List of size k. Each element of the list is a 2-dimensional vector containing the upper and lower
bounds of the k-th functional weight.</p></td>
    </tr>
    <tr>
      <th>batch_size</th>
      <td><p>Size of the batch for stochastic gradient descent.</p></td>
    </tr>
    <tr>
      <th>decay_rate</th>
      <td><p>A modification to the learning rate that decreases the learning rate as more and more learning
iterations are completed.</p></td>
    </tr>
    <tr>
      <th>nfolds</th>
      <td><p>The number of folds to be used in the cross-validation process.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>For the purpose of parallelization.</p></td>
    </tr>
    <tr>
      <th>raw_data</th>
      <td><p>If True, then user does not need to create functional observations beforehand. The function will
internally take care of that pre-processing.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The following are returned:</p>
<p><code>Parameters</code> -- The final list of hyperparameter chosen by the tuning process.</p>
<p><code>All_Information</code> -- A list object containing the errors for every combination in the grid. Each element of the list
corresponds to a different choice of number of hidden layers.</p>
<p><code>Best_Per_Layer</code> -- An object that returns the best parameter combination for each choice of hidden layers.</p>
<p><code>Grid_List</code> -- An object containing information about all combinations tried by the tuning process.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>No additional details for now.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># libraries</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>fda</span>)

<span class='co'># Loading data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"daily"</span>)

<span class='co'># Obtaining response</span>
<span class='no'>total_prec</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>daily</span>$<span class='no'>precav</span>, <span class='fl'>2</span>, <span class='no'>mean</span>)

<span class='co'># Creating functional data</span>
<span class='no'>temp_data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='kw'>dim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>65</span>, <span class='fl'>35</span>, <span class='fl'>1</span>))
<span class='no'>tempbasis65</span>  <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/fda/man/create.fourier.basis.html'>create.fourier.basis</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>365</span>), <span class='fl'>65</span>)
<span class='no'>timepts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>, <span class='fl'>365</span>, <span class='fl'>1</span>)
<span class='no'>temp_fd</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/fda/man/Data2fd.html'>Data2fd</a></span>(<span class='no'>timepts</span>, <span class='no'>daily</span>$<span class='no'>tempav</span>, <span class='no'>tempbasis65</span>)

<span class='co'># Data set up</span>
<span class='no'>temp_data</span>[,,<span class='fl'>1</span>] <span class='kw'>=</span> <span class='no'>temp_fd</span>$<span class='no'>coefs</span>

<span class='co'># Creating grid</span>
<span class='no'>tune_list_weather</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>num_hidden_layers</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>),
                         <span class='kw'>neurons</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>8</span>, <span class='fl'>16</span>),
                         <span class='kw'>epochs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>250</span>),
                         <span class='kw'>val_split</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.2</span>),
                         <span class='kw'>patience</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>15</span>),
                         <span class='kw'>learn_rate</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.01</span>, <span class='fl'>0.1</span>),
                         <span class='kw'>num_basis</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>7</span>),
                         <span class='kw'>activation_choice</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"relu"</span>, <span class='st'>"sigmoid"</span>))

<span class='co'># Running Tuning</span>
<span class='no'>weather_tuned</span> <span class='kw'>=</span> <span class='fu'>fnn.tune</span>(<span class='no'>tune_list_weather</span>,
                         <span class='no'>total_prec</span>,
                         <span class='no'>temp_data</span>,
                         <span class='kw'>basis_choice</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"fourier"</span>),
                         <span class='kw'>domain_range</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>24</span>)),
                         <span class='kw'>nfolds</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'># Looking at results</span>
<span class='no'>weather_tuned</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://b-thi.github.io/'>Barinder Thind</a> <br> Funded by <a href='http://people.stat.sfu.ca/~cao/'>Jiguo Cao</a></p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


