<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FNN • Classification</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Demo #1">
<meta property="og:description" content="FNN">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FNN </a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version"> 1.0 </span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<!-- <li>
  <a href="../index.html">Main</a>
</li> -->
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Demos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Examples</li>
    <li>
      <a href="reg_demo.html">Regression Demo</a>
    </li>
        <li>
      <a href="class_demo.html">Classification Demo</a>
    </li>
        <li>
      <a href="cv_demo.html">Cross-validation Demo</a>
    </li>
        <li>
      <a href="tune_demo.html">Tuning Demo</a>
    </li>
    <li class="divider">
    <li>
      <a href="index.html">Upcoming</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/b-thi/FNN/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Crossvalidation Demo</h1>
            

    </div>

      

</header><div class="row">
<div class="contents col-md-9">
<div id="fnn" class="section level1">
<div id="example" class="section level2">
<!-- <h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Classification Demo</h2> -->
<p>The package functions can be as simple (or complicated) as you want them to be! To illustrate, we’ll use the classic Tecator meat sample dataset for a classification problem.</p>
<p>First, we’ll read in the data and load some libraries.</p>
<div class="sourceCode"><pre class="r"><span class="co"># Library</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">FNN</span>)

<span class="co"># Loading data</span>
<span class="no">tecator</span> <span class="kw">=</span> <span class="kw pkg">FNN</span><span class="kw ns">::</span><span class="no"><a href="reference/tecator.html">tecator</a></span></pre></div>
<p>We’ll do a classification example using meat samples with fat contents &gt; 25 as “high fat” and &lt; 25 as “low fat” as the dependent variable.</p>
<div class="sourceCode"><pre class="r"><span class="co"># Making classification bins</span>
<span class="no">tecator_resp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">tecator</span>$<span class="no">y</span>$<span class="no">Fat</span> <span class="kw">&gt;</span> <span class="fl">25</span>, <span class="fl">1</span>, <span class="fl">0</span>))</pre></div>
<p>We have our response, what about our predictors? Well, to keep it simple, let’s first consider our scalar covariates; we’ll use the water contents of the meat samples as a scalar covariate</p>
<div class="sourceCode"><pre class="r"><span class="co"># Non functional covariate</span>
<span class="no">tecator_scalar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">water</span> <span class="kw">=</span> <span class="no">tecator</span>$<span class="no">y</span>$<span class="no">Water</span>)</pre></div>
<p>Let’s now add some functional covariates:</p>
<div class="sourceCode"><pre class="r"><span class="co"># Splitting data</span>
<span class="no">ind</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">tecator_resp</span>), <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fl">0.75</span>*<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">tecator_resp</span>)))
<span class="no">train_x</span> <span class="kw">=</span> <span class="no">tecator</span>$<span class="no">absorp.fdata</span>$<span class="no">data</span>[<span class="no">ind</span>,]
<span class="no">test_x</span> <span class="kw">=</span> <span class="no">tecator</span>$<span class="no">absorp.fdata</span>$<span class="no">data</span>[-<span class="no">ind</span>,]
<span class="no">scalar_train</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">tecator_scalar</span>[<span class="no">ind</span>,<span class="fl">1</span>])
<span class="no">scalar_test</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">tecator_scalar</span>[-<span class="no">ind</span>,<span class="fl">1</span>])
<span class="no">train_y</span> <span class="kw">=</span> <span class="no">tecator_resp</span>[<span class="no">ind</span>]
<span class="no">test_y</span> <span class="kw">=</span> <span class="no">tecator_resp</span>[-<span class="no">ind</span>]</pre></div>
<p>In the chunk of code above, I split the absorbance curves into a test and train set with a 25/75 split. Since we are doing this the “easy” way, we won’t need to do any pre-processing on the raw absorbance points (of each meat sample). I also split the previously defined scalar covariates and response in the same way.</p>
<p>Before fitting the model, we need to get the functional covariates in the proper format (okay, so there is a little bit of processing). In the case where we are passing in the raw curve points, we need to pass them in as a list of K dimensions where K is the number of functional covariates. In the situation at hand, we only have one functional covariate so our list will have one element:</p>
<div class="sourceCode"><pre class="r"><span class="co"># Making list element to pass in</span>
<span class="no">func_covs_train</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">train_x</span>)
<span class="no">func_covs_test</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">test_x</span>)</pre></div>
<p>Now we can fit the model!</p>
<div class="sourceCode"><pre class="r"><span class="co"># Now running model</span>
<span class="no">fit_class</span> <span class="kw">=</span> <span class="fu"><a href="reference/fnn.fit.html">fnn.fit</a></span>(<span class="kw">resp</span> <span class="kw">=</span> <span class="no">train_y</span>,
                    <span class="kw">func_cov</span> <span class="kw">=</span> <span class="no">func_covs_train</span>,
                    <span class="kw">scalar_cov</span> <span class="kw">=</span> <span class="no">scalar_train</span>,
                    <span class="kw">hidden_layers</span> <span class="kw">=</span> <span class="fl">6</span>,
                    <span class="kw">neurons_per_layer</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">24</span>, <span class="fl">24</span>, <span class="fl">24</span>, <span class="fl">24</span>, <span class="fl">24</span>, <span class="fl">58</span>),
                    <span class="kw">activations_in_layers</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"relu"</span>, <span class="st">"relu"</span>, <span class="st">"relu"</span>, <span class="st">"relu"</span>, <span class="st">"relu"</span>, <span class="st">"linear"</span>),
                    <span class="kw">domain_range</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">850</span>, <span class="fl">1050</span>)),
                    <span class="kw">learn_rate</span> <span class="kw">=</span> <span class="fl">0.001</span>,
                    <span class="kw">epochs</span> <span class="kw">=</span> <span class="fl">100</span>,
                    <span class="kw">raw_data</span> <span class="kw">=</span> <span class="no">T</span>,
                    <span class="kw">early_stopping</span> <span class="kw">=</span> <span class="no">T</span>)</pre></div>
<p>Here, we fit a 6 layer model. There are a number of warnings and error checks in place to make sure that all the dimensionality is consistent. The first three inputs are all objects we defined above! Also, observe that raw_data is true here; this is important to indicate as it tells the model function to do the pre-processing.</p>
<p>Now that we have our model, we can make some predictions:</p>
<div class="sourceCode"><pre class="r"><span class="co"># Running prediction</span>
<span class="no">predict_class</span> <span class="kw">=</span> <span class="fu"><a href="reference/fnn.predict.html">fnn.predict</a></span>(<span class="no">fit_class</span>,
                            <span class="kw">func_cov</span> <span class="kw">=</span> <span class="no">func_covs_test</span>,
                            <span class="kw">scalar_cov</span> <span class="kw">=</span> <span class="no">scalar_test</span>,
                            <span class="kw">domain_range</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">850</span>, <span class="fl">1050</span>)),
                            <span class="kw">raw_data</span> <span class="kw">=</span> <span class="no">T</span>)

<span class="co"># Rounding predictions (they are probabilities)</span>
<span class="no">rounded_preds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">predict_class</span>)[,<span class="fl">2</span>] <span class="kw">==</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>)

<span class="co"># Confusion matrix</span>
<span class="kw pkg">caret</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">rounded_preds</span>), <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">test_y</span>))</pre></div>
<p>Not bad.</p>
<p>Okay that’s all I have for now, have fun!</p>
</div>
</div>
  </div>

</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://b-thi.github.io/'>Barinder Thind</a> <br> Funded by <a href='http://people.stat.sfu.ca/~cao/'>Jiguo Cao</a></p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>
  


  </body>
</html>

